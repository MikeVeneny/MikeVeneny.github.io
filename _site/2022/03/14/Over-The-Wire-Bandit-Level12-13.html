<!DOCTYPE html>

<html lang="en">

    <head>
        <title>Over The Wire: Bandit Level12 13</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="" />
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" />
    <link rel="icon" href="img/favicon.png">
    </head>

    <body>
        <div class="container" >
    <img src="assets/images/Ghidra.png" class="mx-auto d-block" id="header"/>
</div>


<div class="container">
    <nav class="navbar navbar-expand-md">
        <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
        </div>
        <div class="mx-auto order-0">
            <ul class="navbar-nav mr-auto">
                
                <a class="nav-item nav-link" href="/">Home </a>
                
                
                <a class="nav-item nav-link" href="/Projects.html">Projects</a>
                
                
                <a class="nav-item nav-link" href="/writeups.html">WriteUps</a>
                
                
                <a class="nav-item nav-link" href="/notes.html">Notes</a>
                
                
                <a class="nav-item nav-link" href="/about.html">About</a>
                
        </ul>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".dual-collapse2">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
        <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a class="nav-link" href="https://github.com/jolana-veneny"><i class="fab fa-github mr-1"></i></a> </li>
                <li class="nav-item"><a class="nav-link" href="https://www.linkedin.com/in/jolana-veneny/"><i class="fab fa-linkedin mr-1"></i></a> </li>
                <li class="nav-item"><a class="nav-link" href="https://twitter.com/lanaveneny"><i class="fab fa-twitter"></i></a> </li>
                </li>
            </ul>
        </div>
    </nav>
</div>
            <div class="container post">
        <div class="row justify-content-between post-header">
            <div class="col-4">
                <p class="category">14 Mar 2022 - by JLN</p>
            </div>
            <div class="col-2">
                <p class="category">Category: WriteUps</p>
            </div>
        </div>
        <h2 id="over-the-wire-bandit-level-12-13-write-up">Over The Wire: Bandit Level 12-13 Write-Up</h2>
<p>This is a write-up for level 12-13 of the Over The Wire: Bandit. Bandit is a Linux-based wargame.</p>

<p>This is a long and frustrating level because you might end up running in circles before you figure out what is going on. You will be mostly working with the <code class="language-plaintext highlighter-rouge">tar, gzip, bzip2, xxd, mv, file</code> commands so it’s a good idea to figure out what each of them do before you start. When you are done with this level you will realize that the instructions told you everything you needed to know right at the start.</p>

<blockquote>
  <p>Bandit Level 12 → Level 13
The password for the next level is stored in the file data.txt, which is a hexdump of a file that has been repeatedly compressed. For this level it may be useful to create a directory under /tmp in which you can work using mkdir. For example: mkdir /tmp/myname123. Then copy the datafile using cp, and rename it using mv (read the manpages!)
Commands you may need to solve this level
grep, sort, uniq, strings, base64, tr, tar, gzip, bzip2, xxd, mkdir, cp, mv, file
(https://overthewire.org/wargames/bandit/bandit13.html)
First, we need to follow the initial instructions and create your own temporary directory in the bandit’s tmp directory and copy the data.txt file into that directory. Then we change into it.</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:~$ mkdir /tmp/user 
bandit12@bandit:~$ cp data.txt /tmp/user 
bandit12@bandit:/$ cd tmp/user
</code></pre></div></div>

<p>When we <code class="language-plaintext highlighter-rouge">cat</code> the data.txt file we will see something like this:</p>

<p><img src="https://user-images.githubusercontent.com/101567957/158242416-72f8bba6-472f-42eb-a910-1a52674a90cc.png" alt="image" /></p>

<p>As the instructions said, this is a hexdump of a file we need to decompress. This means that to get to the file we need, we need to reverse the hexdump. For this we need to use the <code class="language-plaintext highlighter-rouge">xxd</code> command with the <code class="language-plaintext highlighter-rouge">-r</code> flag. We also need to save the output in a new file data1.txt.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ xxd -r data.txt data1.txt 
</code></pre></div></div>

<p>When you <code class="language-plaintext highlighter-rouge">cat</code> data1.txt you will see that the file isn’t human-readable:</p>

<p><img src="https://user-images.githubusercontent.com/101567957/158242699-4e5dfb8b-f569-444b-a867-883eab3a9f71.png" alt="image" /></p>

<p>At this point we need to figure out what format this file is and we can use the <code class="language-plaintext highlighter-rouge">file</code> command for that.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ file data1.txt
data1.txt: gzip compressed data, was "data2.bin", last modified: Thu May 7 18:14:30 2020, max compression, from Unix 
</code></pre></div></div>

<p>Again, as the instructions warned us, the file is a compressed archive, specifically a gzip archive. However, as only files with the .gz suffix can be decompressed, we first need to rename the file to the correct format using the <code class="language-plaintext highlighter-rouge">mv</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ mv data1.txt data1.gz
</code></pre></div></div>

<p>Then, we can use the <code class="language-plaintext highlighter-rouge">gzip -d</code> command to decompress the file. Checking with <code class="language-plaintext highlighter-rouge">ls</code> we see that we now have a file called data1:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ gzip -d data1.gz
bandit12@bandit:/tmp/user$ ls
data1  data.txt
</code></pre></div></div>

<p>When we look at what type of file data1 is we find this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ file data1
data1: bzip2 compressed data, block size = 900k
</code></pre></div></div>

<p>Bzip2 is a different type of file archive and again we need to use the <code class="language-plaintext highlighter-rouge">-d</code> flag to decompress the file. Bzip2 can decompress without any suffix, so we don’t need to rename the file this time.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ bzip2 -d data1
bzip2: Can't guess original name for data1 -- using data1.out
</code></pre></div></div>

<p>Running <code class="language-plaintext highlighter-rouge">file</code> on data1.out will tell us that, again, it is a gzip file. This means first adding the .gz suffix and then decompressing with the <code class="language-plaintext highlighter-rouge">gzip -d</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ file data1.out
data1.out: gzip compressed data, was "data4.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix
bandit12@bandit:/tmp/user$ mv data1.out data1.gz
bandit12@bandit:/tmp/user$ gzip -d data1.gz
</code></pre></div></div>

<p>This gets us to data1 again and this time <code class="language-plaintext highlighter-rouge">file</code> reveals that it is a tar archive:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ ls
data1  data.txt
bandit12@bandit:/tmp/user$ file data1
data1: POSIX tar archive (GNU)
</code></pre></div></div>

<p>To decompress a tar archive we need to use the <code class="language-plaintext highlighter-rouge">tar</code> command together with the <code class="language-plaintext highlighter-rouge">-xf</code> flags:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ tar -xf data1
</code></pre></div></div>

<p>We get a file called data5.bin which is again a tar archive. We decompress the file once more.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ ls
data1  data5.bin  data.txt
bandit12@bandit:/tmp/user$ file data5.bin
data5.bin: POSIX tar archive (GNU)
bandit12@bandit:/tmp/user$ tar -xf data5.bin
</code></pre></div></div>

<p>This time we see data6.bin file which is a bzip2 file. Without needing to change the suffix, we decompress it with the <code class="language-plaintext highlighter-rouge">bzip2</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ ls
data1  data5.bin  data6.bin  data.txt
bandit12@bandit:/tmp/user$ file data6.bin
data6.bin: bzip2 compressed data, block size = 900k
bandit12@bandit:/tmp/user$ bzip2 -d data6.bin
bzip2: Can't guess original name for data6.bin -- using data6.bin.out
</code></pre></div></div>

<p>The new file, data6.bin.out, is a tar archive which we decompress with the <code class="language-plaintext highlighter-rouge">tar</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ ls
data1  data5.bin  data6.bin.out  data.txt
bandit12@bandit:/tmp/user$ file data6.bin.out
data6.bin.out: POSIX tar archive (GNU)
bandit12@bandit:/tmp/user$ tar -xf data6.bin.out
</code></pre></div></div>
<p>The latest file is data8.bin which file tells us is a gzip.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ ls
data1  data5.bin  data6.bin.out  data8.bin  data.txt
bandit12@bandit:/tmp/user$ file data8.bin
data8.bin: gzip compressed data, was "data9.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix
</code></pre></div></div>

<p>A gzip file needs a .gz suffix before decompressing, so let’s rename it first and then unzip with <code class="language-plaintext highlighter-rouge">gzip -d</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ mv data8.bin data8.bin.gz
bandit12@bandit:/tmp/user$ gzip -d data8.bin.gz
</code></pre></div></div>
<p>Now we check the data8.bin file for its format and we see it’s an ASCII file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ ls
data1  data5.bin  data6.bin.out  data8.bin  data.txt
bandit12@bandit:/tmp/user$ file data8.bin
data8.bin: ASCII text
</code></pre></div></div>

<p>We open the file and yes! There’s your password!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit12@bandit:/tmp/user$ cat data8.bin
The password is XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</code></pre></div></div>

    </div>



        <div class="spacer"></div>
<div class="container">
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4">
    <div class="col-md-4 d-flex align-items-center">
        <span class="text-muted">Website by JLN</span>
    </div>
    <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
        <li class="ms-3"><a class="text-muted" href="https://github.com/jolana-veneny"><i class="fab fa-github mr-1"></i></a> </li>
        <li class="ms-3"><a class="text-muted" href="https://www.linkedin.com/in/jolana-veneny/"><i class="fab fa-linkedin mr-1"></i></a> </li>
        <li class="ms-3"><a class="text-muted" href="https://twitter.com/lanaveneny"><i class="fab fa-twitter"></i></a> </li>
    </ul>
    </footer>
</div>
    </body>

</html>