<!DOCTYPE html>

<html lang="en">

    <head>
        <title>Htb Teleport Write Up</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="" />
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" />
    <link rel="icon" href="img/favicon.png">
    </head>

    <body>
        <div class="container" >
    <img src="assets/images/Ghidra.png" class="mx-auto d-block" id="header"/>
</div>


<div class="container">
    <nav class="navbar navbar-expand-md">
        <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
        </div>
        <div class="mx-auto order-0">
            <ul class="navbar-nav mr-auto">
                
                <a class="nav-item nav-link" href="/">Home </a>
                
                
                <a class="nav-item nav-link" href="/Projects.html">Projects</a>
                
                
                <a class="nav-item nav-link" href="/writeups.html">WriteUps</a>
                
                
                <a class="nav-item nav-link" href="/notes.html">Notes</a>
                
                
                <a class="nav-item nav-link" href="/about.html">About</a>
                
        </ul>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".dual-collapse2">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
        <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a class="nav-link" href="https://github.com/jolana-veneny"><i class="fab fa-github mr-1"></i></a> </li>
                <li class="nav-item"><a class="nav-link" href="https://www.linkedin.com/in/jolana-veneny/"><i class="fab fa-linkedin mr-1"></i></a> </li>
                <li class="nav-item"><a class="nav-link" href="https://twitter.com/lanaveneny"><i class="fab fa-twitter"></i></a> </li>
                </li>
            </ul>
        </div>
    </nav>
</div>
            <div class="container post">
        <div class="row justify-content-between post-header">
            <div class="col-4">
                <p class="category">24 May 2022 - by JLN</p>
            </div>
            <div class="col-2">
                <p class="category">Category: WriteUps</p>
            </div>
        </div>
        <h2 id="htbs-cyber-apocalypse-ctf-2022-teleport-write-up">HTB’s Cyber Apocalypse CTF 2022: Teleport Write-Up</h2>
<p>This is a write-up for the Teleport reverse engineering challenge in the HTB Cyber Apocalypse CTF 2022.<br />
I used Ghidra (and Microsoft Excel) to solve this task.</p>

<blockquote>
  <p>You’ve been sent to a strange planet, inhabited by a species with the natural ability to teleport. If you’re able to capture one, you may be able to synthesise lightweight teleportation technology. However, they don’t want to be caught, and disappear out of your grasp - can you get the drop on them?</p>
</blockquote>

<p>The first step is to upload the binary into Ghidra and have a look at the code in general.</p>

<p><img src="https://user-images.githubusercontent.com/101567957/170101271-dab92b87-ead3-404c-8ad5-03a7679ce100.png" alt="1_overview" /></p>

<p>Straight away, we notice that there is an unusual amount of functions in this binary.
When we click through the functions, we can see that each of them is designed to compare against a specific symbol. In the case of the 00100b2a function that symbol is “t.”</p>

<p><img src="https://user-images.githubusercontent.com/101567957/170102073-1d47ccdd-feff-484c-ba82-10b330bc7a8d.png" alt="4_functions" /></p>

<p>That looks very promising. It could of course be unrelated but when we look at the rest of the functions we can see that they all carry letters, numbers, and most importantly brackets that are used in flags.</p>

<p><img src="https://user-images.githubusercontent.com/101567957/170102676-08defe32-4e0a-437e-9684-bd2068da9abd.png" alt="51_Functions" /></p>

<p>At this point, it is obvious that these functions carry the flag split into individual symbols. The esieast way to put them together (at least for me) is to copy all of these symbols into an excel sheet like this:</p>

<p><img src="https://user-images.githubusercontent.com/101567957/170103077-bbbed312-f59f-48a8-a17d-4b065007efbe.png" alt="7_symbols" />
<img src="https://user-images.githubusercontent.com/101567957/170103087-91fe17f8-cb0d-48e8-b7ef-c4894af95987.png" alt="8_symbols" /></p>

<p>It appears this is the entire flag but I was not able to make out the exact order without any other information. So back to Ghidra we go.
Looking at the assembly code, we can see that about half way through the flag functions start being called. And they seem to be called in the correct, flag order, too!</p>

<p><img src="https://user-images.githubusercontent.com/101567957/170105243-69e90b1b-776f-48ff-a1d7-6698006b273e.png" alt="11_Flag" /></p>

<p><img src="https://user-images.githubusercontent.com/101567957/170105261-76fc7ab3-881b-430d-a872-0f826a12719d.png" alt="12_Flag2" /></p>

<p>Now all we have to do is to simply scroll down the assembly code, look up which function is being called one by one, and write down the symbol each of these functions represents until we get to that final “}.”</p>

<p><img src="https://user-images.githubusercontent.com/101567957/170105836-8606c413-9dac-47c5-8b12-8a6d7d86ec22.png" alt="13_Flag3" /><img src="https://user-images.githubusercontent.com/101567957/170105846-1784a790-4cb4-4457-a643-75fe68273dbe.png" alt="14_Flag4" /></p>

<p>Clean this all up, and we get the full flag:</p>

<p><img src="https://user-images.githubusercontent.com/101567957/170106166-d5b448e8-8704-4466-8d12-6486e87489fb.png" alt="15-Flag_Complete" /></p>


    </div>



        <div class="spacer"></div>
<div class="container">
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4">
    <div class="col-md-4 d-flex align-items-center">
        <span class="text-muted">Website by JLN</span>
    </div>
    <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
        <li class="ms-3"><a class="text-muted" href="https://github.com/jolana-veneny"><i class="fab fa-github mr-1"></i></a> </li>
        <li class="ms-3"><a class="text-muted" href="https://www.linkedin.com/in/jolana-veneny/"><i class="fab fa-linkedin mr-1"></i></a> </li>
        <li class="ms-3"><a class="text-muted" href="https://twitter.com/lanaveneny"><i class="fab fa-twitter"></i></a> </li>
    </ul>
    </footer>
</div>
    </body>

</html>